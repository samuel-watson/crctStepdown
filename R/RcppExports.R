# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

fast_glm_impl <- function(Xs, ys, weightss, offsets, starts, mus, etas, var, mu_eta, linkinv, dev_resids, valideta, validmu, type, tol, maxit) {
    .Call(`_crctStepdown_fast_glm_impl`, Xs, ys, weightss, offsets, starts, mus, etas, var, mu_eta, linkinv, dev_resids, valideta, validmu, type, tol, maxit)
}

#' Simplified version of fastglm's `fastglm` function
#'
#' Fast generalized model fitting with a simplified version of fastglm's `fastglm` function
#' @details
#' This is a simplified wrapper to the `fastglm` function in the fastglm package, please access that package for more details.
#' @param Xs input model matrix. Must be a matrix object
#' @param y numeric response vector
#' @param weightss an optional vector of 'prior weights' to be used in the fitting process. Should be a numeric vector.
#' @param offsets this can be used to specify an a priori known component to be included in the linear predictor during fitting. This should be a numeric vector of length equal to the number of cases
#' @param A \link{stats}[family] object. See `fastglm` for details
#' @return A list with the elements:
#' * `coefficients` a vector of coefficients
#' * `se` a vector of the standard errors of the coefficient estimates
#' * `rank` a scalar denoting the computed rank of the model matrix
#' * `df.residual` a scalar denoting the degrees of freedom in the model
#' * `residuals` a vector of residuals
#' * `s` a numeric scalar - the root mean square for residuals
#' * `fitted.values` the fitted values
myglm <- function(Xs, ys, weightss, offsets, family) {
    .Call(`_crctStepdown_myglm`, Xs, ys, weightss, offsets, family)
}

#' The quasi-score statistic for a generalised linear mixed model
#'
#' Generates the quasi-score statistic for a generalised linear mixed model
#'
#' @param resids A numeric vector of generalised residuals
#' @param tr A numeric vector of 1s (treatment group) and -1s (control group)
#' @param xb A numeric vector of fitted linear predictors
#' @param invS A matrix. If using the weighted statistic then it should be the inverse covariance matrix of the observations
#' @param family2 A string naming the link function
#' @param weight Logical value indicating whether to use the weighted statistic (TRUE) or the unweighted statistic (FALSE)
#' @return A scalar value with the value of the statistic
qscore_impl <- function(resids, tr, xb, invS, family2, weight = TRUE) {
    .Call(`_crctStepdown_qscore_impl`, resids, tr, xb, invS, family2, weight)
}

#' Generates realisations of the permutational test statistic distribution
#'
#' Generates realisations of the permutational test statistic distribution from a given matrix of permutations
#'
#' @param resids A numeric vector of generalised residuals
#' @param tr_mat A matrix. Each column is a new random treatment allocation with 1s (treatment group) and 0s (control group)
#' @param xb A numeric vector of fitted linear predictors
#' @param invS A matrix. If using the weighted statistic then it should be the inverse covariance matrix of the observations
#' @param family2 A string naming the link function
#' @param weight Logical value indicating whether to use the weighted statistic (TRUE) or the unweighted statistic (FALSE)
#' @param verbose Logical indicating whether to report detailed output
#' @return A numeric vector of quasi-score test statistics for each of the permutations
permutation_test_impl <- function(resids, tr_mat, xb, invS, family2, weight, iter = 1000L, verbose = TRUE) {
    .Call(`_crctStepdown_permutation_test_impl`, resids, tr_mat, xb, invS, family2, weight, iter, verbose)
}

#' Confidence interval search procedure
#'
#' Search for the bound of a confidence interval using permutation test statistics
#'
#' @param start Numeric value indicating the starting value for the search procedure
#' @param b Numeric value indicating the parameter estimate
#' @param Xnull_ Numeric matrix. The covariate design matrix with the treatment variable removed
#' @param y_ Numeric vector of response variables
#' @param tr_ Numeric vector. The original random allocation (0s and 1s)
#' @param new_tr_mat A matrix. Each column is a new random treatment allocation with 1s (treatment group) and 0s (control group)
#' @param xb A numeric vector of fitted linear predictors
#' @param invS A matrix. If using the weighted statistic then it should be the inverse covariance matrix of the observations
#' @param family A \link{stats}[family] object
#' @param family2 A string naming the link function
#' @param nsteps Integer specifying the number of steps of the search procedure
#' @param weight Logical indicating whether to use the weighted (TRUE) or unweighted (FALSE) test statistic
#' @param alpha The function generates (1-alpha)*100% confidence intervals. Default is 0.05.
#' @param verbose Logical indicating whether to provide detailed output.
#' @return The estimated confidence interval bound
confint_search <- function(start, b, Xnull_, y_, tr_, new_tr_mat, xb, invS, family, family2, nsteps = 1000L, weight = TRUE, alpha = 0.05, verbose = TRUE) {
    .Call(`_crctStepdown_confint_search`, start, b, Xnull_, y_, tr_, new_tr_mat, xb, invS, family, family2, nsteps, weight, alpha, verbose)
}

qscore <- function(y, x, Tr, cl, ncl) {
    .Call(`_crctStepdown_qscore`, y, x, Tr, cl, ncl)
}

qscorew <- function(y, x, Tr, g, sigma, cl, ncl) {
    .Call(`_crctStepdown_qscorew`, y, x, Tr, g, sigma, cl, ncl)
}

